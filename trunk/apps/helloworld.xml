<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="hello world example">
  	<Require feature="opensocial-0.8"/>
  </ModulePrefs> 
  <Content type="html">
     <![CDATA[ 
     	<script type="text/javascript">
	        function request() {
	            // http://code.google.com/intl/ja/apis/opensocial/docs/0.8/reference/#opensocial.DataRequest
				// コンテナからのソーシャル情報を要求するために使用
				// 友だちのデータ、プロフィール、アプリケーション データ、アクティビティが含まれます。
				// 個人情報へのアクセスを必要とするアプリケーションは、
				// すべて DataRequest を送信する必要がある
	            var req = opensocial.newDataRequest();
	            req.add(req.newFetchPeesonRequest(opensocial.IdSpec.PersonId.OWNER),  "owner");
	            req.add(req.newFetchPeesonRequest(opensocial.IdSpec.PersonId.VIEWER), "viewer");
	            req.send(response);
	        }
	
	        function response(dataResponse) {
	            // http://code.google.com/intl/ja/apis/opensocial/docs/0.8/reference/#opensocial.DataResponse
	            // 要求されたキーにマップされた、要求されたサーバー データが含まれます。
				var owner  = dataResponse.get("owner").getData();
	            var viewer = dataResponse.get("viewer").getData();
	             
				document.getElementById("owner_inf").innerHTML 
					= printPropertiesAsTable(owner);

				document.getElementById("viewer_inf").innerHTML 
					= printPropertiesAsTable(owner);
	        }
	        function printPropertiesAsTable(obj) {
	        	var tbl = "<table>";
			
				for (prop in obj) {
					tbl += "<tr>";
					tbl += "<td>" + prop + "</td>";
					tbl += "<td>" + obj[prop] + "</td>";
					tbl += "</tr>";
				}
	        	tbl += "</table>";
	        	return tbl;
	        }
	        gadgets.util.registerOnLoadHandler(request);
       	</script>
		<div id="owner_inf"/>
		<div id="viewer_inf"/>
     ]]>
  </Content> 
</Module>
