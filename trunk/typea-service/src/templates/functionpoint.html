{% extends "base.html" %}
{% block html_header %}
	<script type="text/javascript"><!-- 
	$(document).ready(function(){
		$.getJSON("/functionpoint/listproject", list_projects);
	});
	function create_new_project() {
		var url = "/functionpoint/createproject";

		var data = new Object();
		data['create_system_name']      = $("#create_system_name").val();
		data['create_application_name'] = $("#create_application_name").val();
		data['create_mesurement_type']  = $("#create_mesurement_type").val();
		
		error_msg();
		processing_msg(PROCESSING_MSG);

		$.getJSON(url, data, list_projects);
	}

	function list_projects(json) {
		if (json.error) {
			error_msg(json.error);
		} else {

			var tbody = $("#projects_table tbody");
			if (tbody.length > 0) {
				tbody.remove();
			}
			var table = $("#projects_table")
			table.append("<tbody></tbody>");

			html = "<tr><th>No</th><th>System Name</th><th>Application Name<th>Mesurment Type</th></tr>";
			for (var i=0; i< json.items.length; i++) {
				html += "<tr><td><a href='" + json.items[i].id + "'>" + (i+1) + "</td>" +
					        "<td>" + json.items[i].system_name + "</td>" + 
				            "<td>" + json.items[i].application_name + "</td>" +
				            "<td>" + json.items[i].mesurement_type_name + "</td></tr>"
			}
			$("#projects_table").append(html);
			
		}
		processing_msg();
	}
	
	function show_project_profile(is_display) {
		if (is_display) {
			$("#new_project_profile").show("normal");
		} else {
			$("#new_project_profile").hide("normal");
		}
	}
	//--></script>
	<title></title>
{% endblock %}
{% block content %}
	<h3>Projects</h3>
	<div id="project_list">
		<a href="javascript:show_project_profile(true);">new project</a>
		<div id="new_project_profile" style="display:none;width:100%;">
			system name:
			<input type="text" id="create_system_name" value="test1" maxlength="30"/>
			application name:
			<input type="text" id="create_application_name" value="test2" maxlength="30"/>
			mesurement type:
			<select id="create_mesurement_type">
			{% for itm in mesurement_type %}
				<option value="{{itm.0}}">{{itm.1}}</option>
			{% endfor %}
			</select>
			<input type="button" value="create" onclick="javascript:create_new_project();"/>
			<input type="button" value="close" onclick="javascript:show_project_profile(false);"/>
		</div>
		<table id="projects_table">
		</table>
	</div>
	
	
	
	
{% endblock %}