<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="skeleton">
  	<Require feature="opensocial-0.8"/>
    <Optional feature="content-rewrite">  
      <Param name="include-urls"></Param>  
      <Param name="exclude-urls">.*</Param>  
      <Param name="include-tags"></Param>
    </Optional> 
  </ModulePrefs> 
  <Content type="html">
     <![CDATA[ 
     	<script type="text/javascript" src="http://typea-mixi01.appspot.com/js/jquery-1.3.2.js"></script>
     	<script type="text/javascript" src="http://typea-info-apps.googlecode.com/svn/trunk/mixi_app/apps/js/typea.js"></script>
     	
     	<script type="text/javascript">
     		var tw = new TwitterUtil();
			var am = new AmazonUtil();
			
	        function search() {
                var query = "q=" + $('#q').attr('value');
                
                twitter_request(tw.search_url(query));
                amazon_request(am.search_url(query));
	        }
     		
     		function twitter_request(url) {
     			$('#q').attr('value', '');
     			var params = {};
				if (url == null) {
	     			var p = [];
	     			p['q'] = 'mixi';
	            	url = tw.search_url(p);
                } 
                params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.GET;
                params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
                gadgets.io.makeRequest(url, twitter_response, params);
	        }
	        
            function amazon_request(url) {
                alert(url);
                
                var params = {};
                params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.GET;
                params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.TEXT;
                gadgets.io.makeRequest(url, amazon_response, params);
            }

            function amazon_response(dataResponse) {
                var html = "";
                alert(dataResponse.data);
                if (dataResponse.data != null) {
                    html = dataResponse.data;
                }
                $('#amazon_content').html = html;
            }
            	        
	        function twitter_response(dataResponse) {
	        	var jsondata = dataResponse.data;
	        	
	        	// make result
	        	$('#twitter_content').html(tw.tw_search_gadget(jsondata, twitter_request));
	        	$('table#twitter_list tr:odd').css('background-color', '#dfffff');
	        	$('#twitter_search_word').css('color', 'blue');
	        	$('#twitter_page').css('color', 'blue')
	        }
	        gadgets.util.registerOnLoadHandler(twitter_request);
       	</script>
        <input type="text" size="16" id="q" /><!--
        --><input type="submit" value="search" onclick="javascript:search();"/>
        <div id="amazon_content"></div>
       	<div id="twitter_content"></div>
     ]]>
  </Content> 
</Module>
